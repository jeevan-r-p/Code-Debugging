<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Debugging Challenge</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-900">
  <div id="start-page" class="flex flex-col items-center justify-center h-screen text-center p-6">
    <h1 class="text-4xl font-bold mb-4">Welcome to Code Debugging Challenge</h1>
    <div class="bg-white shadow-lg rounded-2xl p-6 max-w-xl">
      <h2 class="text-2xl font-semibold mb-2">Rules & Regulations</h2>
      <ul class="list-disc list-inside text-left">
        <li>There are 2 rounds in total.</li>
        <li>Round 1 has 5 questions worth 10 points each.</li>
        <li>Round 2 has 2 questions worth 25 points each.</li>
        <li>You will have 25 minutes to complete each round.</li>
        <li>Once time is up, your answers will be submitted automatically.</li>
      </ul>
      <div class="mt-4">
        <label class="mr-2 font-semibold">Select Language:</label>
        <select id="language-select" class="border p-1 rounded-md">
          <option value="python">Python</option>
          <option value="java">Java</option>
          <option value="c">C</option>
          <option value="cpp">C++</option>
        </select>
      </div>
      <button onclick="startRound(1)" class="mt-6 bg-blue-600 text-white px-6 py-2 rounded-2xl hover:bg-blue-700">Start Round 1</button>
    </div>
  </div>

  <div id="round1" class="hidden p-6">
    <div class="flex justify-between mb-4">
      <h2 class="text-3xl font-bold">Level 1: Error Solving</h2>
      <div class="text-xl font-mono" id="timer1">25:00</div>
    </div>
    <div id="round1-content"></div>
    <button id="next-round-btn" onclick="startRound(2)" class="hidden mt-6 bg-purple-600 text-white px-6 py-2 rounded-2xl hover:bg-purple-700">Go to Round 2</button>
  </div>

  <div id="round2" class="hidden p-6">
    <div class="flex justify-between mb-4">
      <h2 class="text-3xl font-bold">Level 2: Code Rebuild</h2>
      <div class="text-xl font-mono" id="timer2">25:00</div>
    </div>
    <div id="round2-content"></div>
  </div>

  <script>
    let timerInterval;
    let totalSeconds = 25 * 60;
    let currentRound = 1;
    let currentQuestion = 0;
    let language = 'python';

    const rounds = {
      1: [
        { python:`def reverse_number(n):\n    reverse = 0\n    while n != 0:\n        reverse = reverse*10 + n%10\n        n//=10\n    return reverse\n\nn=int(input("Enter integer: "))\nprint("Reversed:", reverse_number(n))`, sample:`Enter integer: 123\nReversed: 321`,
          java:`import java.util.Scanner;\npublic class ReverseNumber { public static void main(String[] args){ Scanner sc=new Scanner(System.in); int n=sc.nextInt(),rev=0; while(n!=0){rev=rev*10+n%10;n/=10;} System.out.println("Reversed: "+rev);}}`,
          c:`#include <stdio.h>\nint main(){ int n,rev=0; scanf("%d",&n); while(n!=0){rev=rev*10+n%10;n/=10;} printf("Reversed: %d\\n",rev); return 0;}`,
          cpp:`#include <iostream>\nusing namespace std;\nint main(){ int n,rev=0; cin>>n; while(n!=0){rev=rev*10+n%10;n/=10;} cout<<"Reversed: "<<rev<<endl; return 0;}` },
        { python:`def is_palindrome(n):\n return str(n)==str(n)[::-1]\nn=int(input("Number: "))\nprint("Palindrome?",is_palindrome(n))`, sample:`Enter number: 121\nPalindrome? True`,
          java:`import java.util.Scanner;\npublic class Palindrome { public static void main(String[] args){ Scanner sc=new Scanner(System.in); int n=sc.nextInt(); String s=""+n; String rev=""; for(int i=s.length()-1;i>=0;i--) rev+=s.charAt(i); System.out.println("Palindrome? "+s.equals(rev));}}`,
          c:`#include <stdio.h>\n#include <string.h>\nint main(){ char s[20]; scanf("%s",s); int len=strlen(s),flag=1; for(int i=0;i<len/2;i++) if(s[i]!=s[len-i-1]) flag=0; printf("Palindrome? %s\\n",flag?"True":"False"); return 0;}`,
          cpp:`#include <iostream>\n#include <string>\nusing namespace std;\nint main(){ string s; cin>>s; string rev=s; reverse(rev.begin(),rev.end()); cout<<"Palindrome? "<<(s==rev?"True":"False")<<endl; return 0;}` },
        { python:`def factorial(n):\n    return 1 if n==0 else n*factorial(n-1)\nn=int(input("Number: "))\nprint("Factorial:",factorial(n))`, sample:`Enter number: 5\nFactorial: 120` },
        { python:`def sum_of_digits(n):\n s=0\n while n>0:\n  s+=n%10\n  n//=10\n print("Sum of digits=",s)\nn=int(input("Number: "))\nsum_of_digits(n)`, sample:`Enter number: 123\nSum of digits=6` },
        { python:`a,b=0,1\nn=int(input("Terms: "))\nfor _ in range(n): print(a,end=' ');a,b=b,a+b`, sample:`Terms: 5\n0 1 1 2 3` }
      ],
      2: [
        { python:`def gcd(a,b):\n while b: a,b=b,a%b\n return a\na=int(input());b=int(input());print("GCD=",gcd(a,b))`, sample:`Enter 12 and 8\nGCD=4` },
        { python:`def convert_binary_to_decimal(n):\n ans=0; p=1\n while n!=0: ans+=n%10*p; p*=2; n//=10\n print("Decimal=",ans)\nn=int(input("Binary: "))\nconvert_binary_to_decimal(n)`, sample:`Binary: 1011\nDecimal=11` }
      ]
    };

    function startTimer() {
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        const minutes = Math.floor(totalSeconds/60);
        const seconds = totalSeconds%60;
        const timerEl=document.getElementById(`timer${currentRound}`);
        if(timerEl) timerEl.textContent=`${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
        if(totalSeconds<=0){
          clearInterval(timerInterval);
          alert('Time is up! Submitting automatically.');
          submitRound();
        }
        totalSeconds--;
      },1000);
    }

    function saveProgress() {
      localStorage.setItem('currentRound',currentRound);
      localStorage.setItem('currentQuestion',currentQuestion);
      let answers={};
      document.querySelectorAll('textarea').forEach(el=>{answers[el.dataset.qid]=el.value;});
      localStorage.setItem('answers',JSON.stringify(answers));
    }

    function loadProgress(){
      const savedRound=localStorage.getItem('currentRound');
      const savedQuestion=localStorage.getItem('currentQuestion');
      const savedAnswers=localStorage.getItem('answers');
      if(savedRound) currentRound=parseInt(savedRound);
      if(savedQuestion) currentQuestion=parseInt(savedQuestion);
      if(savedAnswers){
        const answers=JSON.parse(savedAnswers);
        for(let key in answers){
          const el=document.getElementById(`answer-${key}`);
          if(el) el.value=answers[key];
        }
      }
    }

    function startRound(round){
      language=document.getElementById('language-select').value;
      currentRound=round;
      currentQuestion=0;
      document.getElementById('start-page').classList.add('hidden');
      document.getElementById('round1').classList.add('hidden');
      document.getElementById('round2').classList.add('hidden');
      document.getElementById(`round${round}`).classList.remove('hidden');
      totalSeconds=25*60;
      renderQuestion();
      startTimer();
    }

    function renderQuestion(){
      const q=rounds[currentRound][currentQuestion][language] || rounds[currentRound][currentQuestion].python;
      const sample=rounds[currentRound][currentQuestion].sample || "Sample output not provided";
      const container=document.getElementById(`round${currentRound}-content`);
      container.innerHTML=`
        <div class="bg-black text-green-400 p-4 rounded-2xl font-mono">
          <h3 class="text-lg font-bold text-white">Question ${currentQuestion+1}</h3>
          <pre>${q}</pre>
          <button class="bg-gray-700 text-white px-3 py-1 rounded-md mt-2" onclick="copyCode(${currentQuestion})">Copy Code</button>
          <p class="text-white mt-2">Sample Output:</p>
          <pre>${sample}</pre>
          <textarea data-qid="${currentRound}-${currentQuestion}" id="answer-${currentRound}-${currentQuestion}" class="w-full mt-2 p-2 border rounded-md" placeholder="Paste your solution here..."></textarea>
        </div>
        <div class="flex justify-between mt-4">
          ${currentQuestion>0?`<button class="bg-gray-500 text-white px-4 py-2 rounded-md" onclick="prevQuestion()">Previous</button>`:''}
          ${currentQuestion<rounds[currentRound].length-1?`<button class="bg-blue-600 text-white px-4 py-2 rounded-md" onclick="nextQuestion()">Next</button>`:`<button class="bg-green-600 text-white px-4 py-2 rounded-md" onclick="submitRound()">Submit Round</button>`}
        </div>`;
      saveProgress();
    }

    function copyCode(qIndex){
      navigator.clipboard.writeText(rounds[currentRound][qIndex][language] || rounds[currentRound][qIndex].python);
      alert('Code copied!');
    }

    function nextQuestion(){ currentQuestion++; renderQuestion(); }
    function prevQuestion(){ currentQuestion--; renderQuestion(); }

    function submitRound(){
      clearInterval(timerInterval);
      const submissionTime=new Date().toLocaleTimeString();
      document.getElementById(`round${currentRound}-content`).innerHTML=`<h2 class='text-xl font-bold'>Round ${currentRound} submitted at ${submissionTime}</h2>`;
      if(currentRound===1) document.getElementById('next-round-btn').classList.remove('hidden');
      saveProgress();
    }

    window.onload=()=>loadProgress();
    window.startRound=startRound;
    window.renderQuestion=renderQuestion;
    window.copyCode=copyCode;
    window.nextQuestion=nextQuestion;
    window.prevQuestion=prevQuestion;
    window.submitRound=submitRound;
  </script>
</body>
</html>
